---
author: 7wen
tags: Java
pageview: true
layout: article
title: Javaå¤æ‚sqlé›†åˆğŸ˜‚
article_header:
  type: overlay
  theme: dark
  background_color: '#203028'
  background_image:
    gradient: 'linear-gradient(135deg, rgba(34, 139, 87 , .4), rgba(139, 34, 139, .4))'
    src: docs\assets\images\cool.jpeg
---



## Javaå°±æ˜¯ä¸€ä¸ªæ†¨æ†¨ï¼

ï¼ˆ1ï¼‰åˆå¹¶å¤„ç†å¤šå¼ è¡¨,å¹¶åˆ†å¼€åˆ¤æ–­å¯¹åº”çš„å­—æ®µå±æ€§,è¦æ³¨æ„ç­›é€‰çš„æ•°æ®éœ€è¦å¤šå¼ è¡¨éƒ½æœ‰, union all å­—æ®µå¯ä»¥é‡å¤æ•°æ®åº”ç”¨ åˆ—è¡¨åˆ—å‡ºä¸“å®¶æ˜¯å¦å‚åŠ äº†è¯„æ ‡, æ˜¯çº¿ä¸Šè¯„æ ‡è¿˜æ˜¯çº¿ä¸‹ç£‹å•†,ä¸¤è€…è¦å–å¾—å­—æ®µæ•°æ®æ˜¯ä¸€è‡´çš„,å¦‚æœè¦åŒºåˆ†å¯è§ä¸‹åˆ—

```sql
mapper
select
a.reviewType,
a.isJoinState,
a.stage,
a.tender_number,
a.project_title,
a.stp_date_timefrom 
(select
 -- 0è¡¨ç¤ºçº¿ä¸Šè¯„æ ‡
 'çº¿ä¸Šè¯„æ ‡' as reviewType,
 tr.is_refuse as  isJoinState,
 t.stage,t.tender_number,
 t.project_title,
 t.stp_date_timefromtender_random_expert_record as tr,
 tender t
 <where>    
 t.id = tr.tender_id    
 and    
 tr.expert_id = #{userId}    
 and    
 tr.is_read = true
 </where>
 UNION all
 select
 -- 1è¡¨ç¤ºçº¿ä¸‹ç£‹å•†
 'çº¿ä¸‹ç£‹å•†' as reviewType,
 td.is_refuse as isJoinState,
 t.stage,
 t.tender_number,
 t.project_title,
 t.stp_date_timefromtender_discussion_person td,
 tender t
 <where>    
 td.tender_id = t.id    
 and    
 td.participate_user_id = #{userId}    
 and    
 td.is_read = true</where>) as a
 
 
 --å–æŸè¡¨ä¸­æœ€æ–°çš„æ›´æ–°æ—¶é—´çš„ä¸€æ¡è®°å½•
 select 
 å­—æ®µå,max(æ›´æ–°æ—¶é—´å­—æ®µ) 
 as ... from è¡¨ 
 group by 
 å­—æ®µå
 select
 user_id,
 max(create_date_time) 
 create_date_time
 from
 log_user_login
 group by
 user_id
```

##### ï¼ˆ2ï¼‰å¯¹æŸå†™æ•°æ®é›†åšå»é‡ä¸”æ ¹æ®æ—¶é—´å€’åºæ’åºï¼ˆdistinctäºorder byå…±å­˜çš„æƒ…å†µï¼‰

```sql
-- tenderidä¸ºæ ‡ä¹¦id own_company_idä¸ºæŠ•æ ‡äººçš„å…¬å¸id æ‰¾å‡ºå”¯ä¸€æ ‡ä¹¦çš„å”¯ä¸€å…¬å¸ä¸»æ•°æ®é›†åˆï¼Œè®¢å•å¯å¦ä¸€ä¸ªæ¥å£å®‰æ’
select 
a.*,
(select 
 max(create_date_time) 
 from tender_order 
 where tender_id = a.tender_id and 
 own_company_id = a.company_id 
) as create_date_time
from (
	SELECT DISTINCT
		c.company_name,
		c.id company_id,
		t.project_title,
		t.stage,
		t.tender_number,
		t.id tender_id,
		tor.own_user_id as own_user_id,
		tor.own_user_name as  contact_person,
		u.mobile as contact_mobile
	FROM
		tender t,
		company c,
		tender_order tor,
		`user` u 
	WHERE
		tor.tender_id = t.id 
		AND tor.own_company_id = c.id 
		AND tor.is_delete = FALSE 
		AND tor.own_user_id = u.id
		) a
	order by create_date_time desc
```

