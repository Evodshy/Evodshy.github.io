---
author: 7wen
---

合并处理多张表,并分开判断对应的字段属性,要注意筛选的数据需要多张表都有, union all 字段可以重复数据应用 列表列出专家是否参加了评标, 是线上评标还是线下磋商,两者要取得字段数据是一致的,如果要区分可见下列

```sql
mapper
select
a.reviewType,
a.isJoinState,
a.stage,
a.tender_number,
a.project_title,
a.stp_date_timefrom 
(select
 -- 0表示线上评标
 '线上评标' as reviewType,
 tr.is_refuse as  isJoinState,
 t.stage,t.tender_number,
 t.project_title,
 t.stp_date_timefromtender_random_expert_record as tr,
 tender t
 <where>    
 t.id = tr.tender_id    
 and    
 tr.expert_id = #{userId}    
 and    
 tr.is_read = true
 </where>
 UNION all
 select
 -- 1表示线下磋商
 '线下磋商' as reviewType,
 td.is_refuse as isJoinState,
 t.stage,
 t.tender_number,
 t.project_title,
 t.stp_date_timefromtender_discussion_person td,
 tender t
 <where>    
 td.tender_id = t.id    
 and    
 td.participate_user_id = #{userId}    
 and    
 td.is_read = true</where>) as a
 
 
 --取某表中最新的更新时间的一条记录
 select 
 字段名,max(更新时间字段) 
 as ... from 表 
 group by 
 字段名
 select
 user_id,
 max(create_date_time) 
 create_date_time
 from
 log_user_login
 group by
 user_id
```